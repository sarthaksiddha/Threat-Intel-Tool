rule generic_malware {
    meta:
        description = "Generic malware detection"
        author = "Threat Intel Tool"
        date = "2024-12-27"
    strings:
        $backdoor = /backdoor|trojan|rootkit/i
        $suspicious_apis = /CreateRemoteThread|VirtualAlloc|WriteProcessMemory/
        $encryption = {68 ?? ?? ?? ?? 68 ?? ?? ?? ?? E8}
    condition:
        any of them
}

rule ransomware {
    meta:
        description = "Ransomware detection"
    strings:
        $encrypt_files = /CryptoAPI|encrypt.*files/i
        $ransom_note = /ransom|payment|bitcoin/i
    condition:
        all of them
}